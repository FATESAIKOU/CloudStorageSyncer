# Data Model Design for Download and Delete Features

## 概要
為支援下載和刪除功能，需要新增相應的資料模型來處理請求和回應。這些模型將遵循既有的設計模式，確保系統一致性。

## 0. 全體資料結構關聯圖

### 0.1 Model 類別關係圖
```plantuml
@startuml
title Data Model Relationships

package "Configuration Models" {
  class S3Config {
    +access_key: str
    +secret_key: str
    +bucket: str
    +region: str
    +is_valid(): bool
  }

  enum S3StorageClass {
    STANDARD
    STANDARD_IA
    ONEZONE_IA
    INTELLIGENT_TIERING
    GLACIER
    GLACIER_IR
    DEEP_ARCHIVE
  }
}

package "Request Models" {
  class UploadRequest {
    +file_path: str
    +s3_key: str
    +storage_class: S3StorageClass | None
  }

  class DownloadRequest {
    +s3_key: str
    +output_path: str | None
    +overwrite: bool
  }

  class DeleteRequest {
    +s3_key: str
    +force: bool
  }
}

package "Result Models" {
  class UploadResult {
    +success: bool
    +s3_url: str | None
    +storage_class: str | None
    +error_message: str | None
  }

  class DownloadResult {
    +success: bool
    +s3_key: str
    +local_path: str | None
    +file_size: int | None
    +error_message: str | None
  }

  class DeleteResult {
    +success: bool
    +s3_key: str
    +existed_before_delete: bool
    +error_message: str | None
  }
}

' Model 之間的關係
UploadRequest --> S3StorageClass : uses
UploadRequest ..> UploadResult : "transforms to"
DownloadRequest ..> DownloadResult : "transforms to"
DeleteRequest ..> DeleteResult : "transforms to"

note top of UploadRequest : "Request Models 包含操作參數"
note top of UploadResult : "Result Models 包含操作結果"
note bottom : "Request → Result 轉換關係\n各 Request/Result 配對獨立設計"

@enduml
```

### 0.2 Model 繼承與依賴關係
```plantuml
@startuml
title Model Dependencies and Transformations

' 依賴關係 (Dependency)
UploadRequest --> S3StorageClass : "depends on"

' 轉換關係 (Transformation)
UploadRequest ..> UploadResult : "<<transforms>>"
DownloadRequest ..> DownloadResult : "<<transforms>>"
DeleteRequest ..> DeleteResult : "<<transforms>>"

' 資料流向
note on link : "1:1 轉換關係"

@enduml
```

## 1. Model 類別設計概要

### 1.1 Configuration Models
- **S3Config**: 系統配置模型
- **S3StorageClass**: 儲存等級枚舉

### 1.2 Request Models
- **UploadRequest**: 上傳請求模型
- **DownloadRequest**: 下載請求模型（新增）
- **DeleteRequest**: 刪除請求模型（新增）

### 1.3 Result Models
- **UploadResult**: 上傳結果模型
- **DownloadResult**: 下載結果模型（新增）
- **DeleteResult**: 刪除結果模型（新增）

## 2. Model 關係分析

### 2.1 依賴關係 (Dependency)
- UploadRequest → S3StorageClass: 上傳請求依賴儲存等級配置

### 2.2 轉換關係 (Transformation)
- UploadRequest → UploadResult: 1:1 請求-結果轉換
- DownloadRequest → DownloadResult: 1:1 請求-結果轉換
- DeleteRequest → DeleteResult: 1:1 請求-結果轉換

### 2.3 模型分組
- **配置模型組**: S3Config, S3StorageClass
- **操作模型組**: Request/Result 配對
- **功能模型組**: Upload, Download, Delete 各自獨立

## 3. 設計原則

### 3.1 獨立性原則
- 各 Request/Result 配對獨立設計
- 不強制繼承共同介面
- 保持模型簡潔性

### 3.2 一致性原則
- 相同的錯誤處理模式（error_message 欄位）
- 相同的成功標示模式（success 欄位）
- 相同的工廠方法命名慣例

### 3.3 擴充性原則
- 模型設計支援未來功能擴充
- 預留批次操作的設計空間
